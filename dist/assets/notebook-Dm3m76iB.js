const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/select-notebook-form-BicFOkGo.js","assets/index-lzanjXxa.js","assets/mui-vendor-CW2_5rLd.js","assets/react-vendor-DLlvbPZt.js","assets/redux-vendor-BvN4x8k-.js","assets/index-YONYTqsV.css","assets/select-notebook-form-Cv9yF_Pq.css","assets/add-notebook-form-DMBXR6ta.js","assets/add-notebook-form-CyaaJRdQ.css"])))=>i.map(i=>d[i]);
import{e as k,A as L,u as me,a as _e,b as Ne,c as H,L as pe,d as be,_ as W}from"./index-lzanjXxa.js";import{j as t,u as ge,C as we,a as xe,F as O,v as ke,E as ye,w as Q,x as Ee,y as Se}from"./mui-vendor-CW2_5rLd.js";import{r as s,L as je,m as ve,u as $e}from"./react-vendor-DLlvbPZt.js";import{D as Te,g as Ae}from"./getNotebooks-DJOpqDWG.js";import{m as Ce,V as Oe,b as Le,g as Me}from"./getNotebook-DMbyxFbx.js";import{F as De}from"./footer-DmwuNB4o.js";import"./redux-vendor-BvN4x8k-.js";import"./markdown-vendor-BgXz8MM8.js";const Fe="_notes_list_1803a_1",Re="_notebook_list_bg_1803a_25",Ie="_thumb_select_1803a_33",ze="_note_list_card_1803a_47",He="_thumb_image_1803a_103",Pe="_thumb_outer_link_1803a_177",Be="_thumb_outer_1803a_177",Ve="_edit_link_1803a_211",S={notes_list:Fe,notebook_list_bg:Re,thumb_select:Ie,note_list_card:ze,thumb_image:He,thumb_outer_link:Pe,thumb_outer:Be,edit_link:Ve},Je="_box_wm1eb_11",Ue={box:Je};window.Buffer=Le.Buffer;const Ke=u=>{const{content:a}=Ce(u.text),[n,r]=s.useState(!1),c=s.useCallback(i=>{u.updatedViewText=i},[u]);return s.useEffect(()=>{let i;return i=setTimeout(()=>{r(!0)},600),()=>{clearTimeout(i)}},[a]),n?t.jsx("div",{className:Ue.box,children:t.jsx("article",{className:"viewnote_content viewnote_thumb",children:t.jsx(Oe,{viewText:a,updatedViewText:c,disableLinks:!0})})}):t.jsx(ge,{variant:"rounded",height:15})},Ge=u=>{const[a,n]=s.useState(),[r,c]=s.useState([]),[i,l]=s.useState(),{onNotesSelected:m}=u,{onNotesEdit:h}=u,{onClearNotesEdit:j}=u,v=u.notes;s.useEffect(()=>{j&&l(d=>({...d,selected:[]}))},[j]),s.useEffect(()=>{if(v){n(v);let d=[];v.forEach(b=>{c(p=>{let g={id:b._id,selected:!1};return d.push(g),d})})}},[v]),s.useEffect(()=>{i&&m(i)},[i,m]);const T=(d,b)=>{c(p=>{let g=[...p];const w=r==null?void 0:r.findIndex(z=>z.id===d);return w>=0&&g.length>0&&(g[w].selected=b),g}),l(p=>{let g={selected:[]};return r==null||r.forEach(w=>{w.selected&&g.selected.push(w.id)}),{...p,selected:g.selected}})},y=d=>{const b=d.currentTarget,{checked:p}=b,g=b.value;T(g,p)},$=d=>{const b=document.getElementById(`input_${d}`);let{checked:p}=b;const g=b.value;b.checked=!p,p=b.checked,T(g,p)},I=d=>{h&&d.preventDefault()},M=d=>{h&&$(d)};return t.jsx(s.Fragment,{children:a&&t.jsx("ul",{className:S.notes_list,children:a.map(d=>t.jsx("li",{className:S.notebook_list_bg,children:t.jsxs("div",{className:S.thumb_outer,children:[t.jsx(je,{className:S.thumb_outer_link,onClick:I,to:`/notebook/${d.notebook}/${d._id}`,children:t.jsx("div",{className:S.thumb_outer_link,children:t.jsx("div",{id:d._id,className:S.edit_link,onClick:()=>M(d._id),children:t.jsx(we,{sx:{width:"100%"},className:S.note_list_card,children:t.jsxs(xe,{className:S.cardcontent,children:[t.jsx("div",{className:S.thumb_image,children:t.jsx(qe,{text:d.note})}),t.jsx("div",{className:"date_format date_format_notes",children:t.jsx(Te,{dateString:d.updatedAt})})]})})})})}),h&&t.jsx("div",{className:S.thumb_select,children:t.jsx("input",{id:`input_${d._id}`,type:"checkbox",name:"Status",value:d._id,onChange:y})})]})},d._id))})})},qe=s.memo(Ke),Qe=s.memo(Ge),We=L,Xe=async(u,a)=>{let n;try{if(n=await fetch(`https://www.snipbee.com/api/data/notes/${a}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`}}),n.status===404)throw new Error(`${n.url} Not Found.`)}catch(c){return{error:k(c)}}let r;try{if(r=await n.json(),r===null)return{error:`${We.NOTES_ERROR}`}}catch(c){return{error:k(c)}}return r.error?{error:r.error}:r},Ye=L,Ze=async(u,a)=>{let n;const r={note_ids:a};try{if(n=await fetch("https://www.snipbee.com/api/data/delete-notes",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`},body:JSON.stringify(r)}),n.status===404)throw new Error(`${n.url} Not Found.`)}catch(i){return{error:k(i)}}let c;try{if(c=await n.json(),c===null)return{error:`${Ye.NOTES_DELETE_ERROR}`}}catch(i){return{error:k(i)}}return c.error?{error:c.error}:c},et=L,tt=async(u,a,n)=>{let r;const c={notebookID:a,notebookUpdated:n};try{if(r=await fetch("https://www.snipbee.com/api/data/edit-notebook-date",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`},body:JSON.stringify(c)}),r.status===404)throw new Error(`${r.url} Not Found.`)}catch(l){return{error:k(l)}}let i;try{if(i=await r.json(),i===null)return{error:`${et.NOTEBOOK_UPDATE_DATE_ERROR}`}}catch(l){return{error:k(l)}}return i.error?{error:i.error}:i},rt=L,st=async(u,a,n,r)=>{let c;const i={notes:n,notebookID:a,latestUpdatedNote:r};try{if(c=await fetch("https://www.snipbee.com/api/data/move-notes",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`},body:JSON.stringify(i)}),c.status===404)throw new Error(`${c.url} Not Found.`)}catch(m){return{error:k(m)}}let l;try{if(l=await c.json(),l===null)return{error:`${rt.NOTES_ERROR}`}}catch(m){return{error:k(m)}}return l.error?{error:l.error}:l},ot=L,nt=async(u,a)=>{let n;try{const c={notebookID:a};if(n=await fetch("https://www.snipbee.com/api/data/delete-notebook",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`},body:JSON.stringify(c)}),n.status===404)throw new Error(`${n.url} Not Found.`)}catch(c){return{error:k(c)}}let r;try{if(r=await n.json(),r===null)return{error:`${ot.NOTEBOOK_DELETE_ERROR}`}}catch(c){return{error:k(c)}}return r.error?{error:r.error}:r},at=L,ct=async(u,a,n,r,c)=>{let i;const l={notebookID:a,notebookName:n,notebookCover:r,notebookUpdated:c};try{if(i=await fetch("https://www.snipbee.com/api/data/edit-notebook",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`},body:JSON.stringify(l)}),i.status===404)throw new Error(`${i.url} Not Found.`)}catch(h){return{error:k(h)}}let m;try{if(m=await i.json(),m===null)return{error:`${at.NOTES_ERROR}`}}catch(h){return{error:k(h)}}return m.error?{error:m.error}:m},it=s.lazy(()=>W(()=>import("./select-notebook-form-BicFOkGo.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),dt=s.lazy(()=>W(()=>import("./add-notebook-form-DMBXR6ta.js"),__vite__mapDeps([7,1,2,3,4,5,8]))),lt=()=>s.useContext(be),ut=()=>{const{authContext:u}=lt(),{token:a}=u,{notebookId:n}=ve(),r=me(),c=_e(e=>e.edit.editing),i=$e(),[l,m]=s.useState(),[h,j]=s.useState(!1),[v,T]=s.useState(!1),[y,$]=s.useState(!1),[I,M]=s.useState(!1),[d,b]=s.useState(),[p,g]=s.useState(),[w,z]=s.useState(),[X,P]=s.useState(!1),[Y,B]=s.useState(!1),[D,K]=s.useState(!1),[Z,G]=s.useState(!1),N=s.useCallback(e=>{r(Ne.showNotification({status:"error",title:"Error!",message:e}))},[r]),V=s.useCallback(e=>(e.forEach(o=>{o.updatedAt==="No date"&&(o.updatedAt="December 17, 1995 03:24:00")}),e.sort((o,f)=>o.updatedAt!==void 0&&f.updatedAt!==void 0?new Date(o.updatedAt)>new Date(f.updatedAt)?1:-1:o.updatedAt!==void 0?1:-1).reverse(),e),[]);s.useEffect(()=>{c.status===!0&&oe()},[c]),s.useEffect(()=>{let e;return v&&(e=setTimeout(()=>{j(!0)},100)),()=>clearTimeout(e)},[v]),s.useEffect(()=>{!n||!a||((async()=>{if(!h){T(!1),j(!1);try{const e=await Xe(a,n);if($(!0),e.error){N(`${e.error}`);return}if(e.success){const o=V(e.notes);m(o),T(!0)}}catch(e){N(`${e}`),T(!0);return}}})(),(async()=>{if(!y){$(!1);try{const e=await Me(a,n);if($(!0),e.error){N(`${e.error}`);return}e.success&&(b(e.notebook),r(H.editChange({message:e.notebook})))}catch(e){N(`${e}`),$(!0);return}}})(),(async()=>{if(!I){M(!1);try{const e=await Ae(a);if(M(!0),e.error){N(`${e.error}`);return}e.success&&g(e.notebooks)}catch(e){N(`${e}`),M(!0);return}}})())},[a,n,V,r,y,I,h,N]);const ee=e=>{z(e)},te=()=>{P(!0)},re=()=>{P(!1)},se=()=>{B(!1),r(H.editStatus({status:!1}))},oe=()=>{B(!0)},ne=()=>{i(`/notebook/${n}/create-note`)},ae=()=>{K(!0),G(!1)},ce=()=>{z(e=>({...e,selected:{selected:[]}.selected}))},J=()=>{K(!1),G(!0),ce()},q=(e,o)=>{de(e,o)},ie=async()=>{let e;if(a&&w!==null&&w!==void 0){e=w.selected;try{const o=await Ze(a,e);if($(!0),o.error){N(`${o.error}`);return}if(o.success){let f;const x=l[0].updatedAt;if(m(_=>{let E,A=[];if(_){E=[..._];let R=E.length;for(;R--;){var F=E[R];e.indexOf(F._id)===-1&&A.push(F)}const C=A.reverse();return C.length>0&&(f=C[0].updatedAt),C}}),f!==void 0&&n!==void 0&&x&&new Date(f).getTime()!==new Date(x).getTime()){let _=String(n);q(_,f)}J()}}catch(o){N(`${o}`);return}}},de=async(e,o)=>{if(a&&e&&o)try{const f=await tt(a,e,o);if(f.error){N(`${f.error}`);return}f.success}catch(f){N(`${f}`);return}},le=async()=>{const e=d._id;if(a&&e&&e.length>0)try{const o=await nt(a,e);if(o.error){N(`${o.error}`);return}o.success&&i("/notebooks")}catch(o){N(`${o}`);return}},ue=async(e,o,f,x)=>{if(a&&e&&o&&f&&x)try{const _=await ct(a,e,o,f,x);if(_.error){N(`${_.error}`);return}_.success&&(b(_.notebook_edited),r(H.editStatus({status:!1})),r(H.editChange({message:_.notebook_edited})),B(!1))}catch(_){N(`${_}`);return}},he=e=>{let o=[];for(const _ in e)if(l){var f=l.filter(E=>E._id===e[_]);o.push(f[0])}return V(o)[0].updatedAt},fe=async e=>{let o;if(a&&e&&w!==null&&w!==void 0){o=w.selected;const f=he(o);try{const x=await st(a,e,o,f);if(x.error){N(`${x.error}`);return}if(x.success){let _;if(m(E=>{let A,F=[];if(E){A=[...E];let C=A.length;for(;C--;){var R=A[C];o.indexOf(R._id)===-1&&F.push(R)}const U=F.reverse();return U.length>0&&(_=U[0].updatedAt),U}}),_!==void 0&&n!==void 0){let E=String(n);q(E,_)}P(!1),J()}}catch(x){N(`${x}`);return}}};return t.jsxs(s.Fragment,{children:[(!y||!h)&&t.jsx(pe,{}),y&&h&&d&&l&&t.jsxs("div",{className:"page_scrollable_header_breadcrumb_footer_list",children:[l&&d&&h&&t.jsx(ht,{notes:l,onNotesSelected:ee,onNotesEdit:D,onClearNotesEdit:Z}),X&&p&&t.jsx(s.Suspense,{fallback:t.jsx("div",{children:"Loading..."}),children:t.jsx(it,{notebooks:p,moveNotes:fe,onCancel:re})}),Y&&t.jsx(s.Suspense,{fallback:t.jsx("div",{children:"Loading..."}),children:t.jsx(dt,{method:"edit",notebook:d,editNotebook:ue,onCancel:se})})]}),t.jsxs(De,{children:[y&&h&&!D&&t.jsxs(O,{variant:"extended",color:"secondary",size:"medium",onClick:ne,children:[t.jsx(ke,{sx:{mr:1}}),"Add Note"]}),y&&h&&!D&&l&&l.length>0&&t.jsxs(O,{variant:"extended",color:"secondary",size:"medium",onClick:ae,children:[t.jsx(ye,{sx:{mr:1}}),"Edit Notes"]}),y&&h&&l&&l.length<1&&t.jsxs(O,{variant:"extended",color:"secondary",size:"medium",onClick:le,children:[t.jsx(Q,{sx:{mr:1}}),"Delete Notebook"]}),y&&h&&D&&w&&w.selected.length>0&&t.jsxs(s.Fragment,{children:[t.jsxs(O,{variant:"extended",color:"secondary",size:"medium",onClick:ie,children:[t.jsx(Q,{sx:{mr:1}}),"Delete"]}),p&&p.length>1&&t.jsxs(O,{variant:"extended",color:"secondary",size:"medium",onClick:te,children:[t.jsx(Ee,{sx:{mr:1}}),"Move"]})]}),y&&h&&D&&t.jsxs(O,{variant:"extended",color:"secondary",size:"medium",onClick:J,children:[t.jsx(Se,{sx:{mr:1}}),"Cancel"]})]})]})},ht=s.memo(Qe),xt=s.memo(ut);export{xt as default};
