const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/add-notebook-form-DMBXR6ta.js","assets/index-lzanjXxa.js","assets/mui-vendor-CW2_5rLd.js","assets/react-vendor-DLlvbPZt.js","assets/redux-vendor-BvN4x8k-.js","assets/index-YONYTqsV.css","assets/add-notebook-form-CyaaJRdQ.css"])))=>i.map(i=>d[i]);
import{j as t,C,a as w,u as p,F as E,z as y}from"./mui-vendor-CW2_5rLd.js";import{r as e,L as S}from"./react-vendor-DLlvbPZt.js";import{e as j,A as F,u as N,b as x,L as A,d as v,_ as L}from"./index-lzanjXxa.js";import{F as $}from"./footer-DmwuNB4o.js";import{D as T,g as D}from"./getNotebooks-DJOpqDWG.js";import"./redux-vendor-BvN4x8k-.js";const O="_notebooks_list_it5pu_1",R="_notebooks_list_left_it5pu_45",P="_notebooks_list_right_it5pu_59",I="_notebooks_list_outer_it5pu_75",z="_cardcontent_it5pu_87",M="_notebooks_list_bg_it5pu_103",B="_notebook_default_it5pu_111",H="_tab_default_it5pu_121",K="_tab_red_it5pu_129",W="_tab_blue_it5pu_135",J="_tab_green_it5pu_141",U="_tab_loading_it5pu_149",b={notebooks_list:O,notebooks_list_left:R,notebooks_list_right:P,notebooks_list_outer:I,cardcontent:z,notebooks_list_bg:M,notebook_default:B,tab_default:H,tab_red:K,tab_blue:W,tab_green:J,tab_loading:U},V=r=>{const{notebook_item:d}=r,[c,a]=e.useState(!1);e.useEffect(()=>{let o;return o=setTimeout(()=>{a(!0)},100),()=>{clearTimeout(o)}},[d]);const i=t.jsx("li",{className:`${b.notebooks_list_bg}`,children:t.jsx(C,{sx:{width:"100%"},children:t.jsx(w,{className:b.cardcontent,children:t.jsxs("div",{className:b.notebooks_list_outer,children:[t.jsx("div",{className:`${b.notebooks_list_left}  ${b[c?"tab_"+d.notebook_cover:""]}`,children:c?"":t.jsx(p,{variant:"rounded",sx:{height:"100%"}})}),t.jsx("div",{className:b.notebooks_list_right,children:c?t.jsxs(e.Fragment,{children:[t.jsx("div",{children:d.notebook_name}),t.jsx("div",{className:"date_format",children:t.jsx(T,{dateString:d.updatedAt})})]}):t.jsxs(e.Fragment,{children:[t.jsx(p,{variant:"text"}),t.jsx(p,{variant:"text"})]})})]})})})});return t.jsx(e.Fragment,{children:c?t.jsx(S,{to:`/notebook/${d._id}`,children:i},d._id):i})},q=F,G=async(r,d,c)=>{let a;try{const o={notebookName:d,notebookCover:c};if(a=await fetch("https://www.snipbee.com/api/data/addnotebook",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(o)}),a.status===404)throw new Error(`${a.url} Not Found.`)}catch(o){return{error:j(o)}}let i;try{if(i=await a.json(),i===null)return{error:`${q.NOTEBOOK_CREATE_ERROR}`}}catch(o){return{error:j(o)}}return i.error?{error:i.error}:i},Q=e.lazy(()=>L(()=>import("./add-notebook-form-DMBXR6ta.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),X=()=>e.useContext(v),Y=r=>{const{authContext:d}=X(),{token:c}=d,a=N(),[i,o]=e.useState(!1),[_,k]=e.useState([]),u=e.useCallback(l=>{a(x.showNotification({status:"error",title:"Error!",message:l}))},[a]);e.useEffect(()=>{if(r.notebooks&&r.notebooks.success&&r.notebooks.notebooks){const l=r.notebooks.notebooks;k(l)}r.notebooks&&r.notebooks.error&&a(x.showNotification({status:"error",title:"Error!",message:r.notebooks.error}))},[r.notebooks,a]);const n=()=>{o(!0)},g=()=>{o(!1)},f=async(l,h)=>{if(c)try{o(!1);const s=await G(c,l,h);if(s.error){u(`${s.error}`);return}s.success&&(console.log(s.error),k(m=>[{_id:s.notebook._id,notebook_name:s.notebook.notebook_name,notebook_cover:s.notebook.notebook_cover,updatedAt:s.notebook.updatedAt,createdAt:s.notebook.createdAt},...m]))}catch(s){u(`${s}`);return}};return t.jsxs(e.Fragment,{children:[t.jsxs("div",{children:[!_&&t.jsx(A,{}),_&&t.jsx("ul",{className:b.notebooks_list,children:_.map((l,h)=>t.jsx("div",{children:t.jsx(V,{notebook_item:l})},h))}),i&&t.jsx(e.Suspense,{fallback:t.jsx("div",{children:"Page is Loading..."}),children:t.jsx(Q,{method:"create",addNotebook:f,onCancel:g})})]}),t.jsx($,{children:_&&t.jsxs(E,{variant:"extended",color:"secondary",size:"medium",onClick:n,children:[t.jsx(y,{sx:{mr:1}}),"Add Notebook"]})})]})},Z=()=>e.useContext(v),at=()=>{const r=N(),{authContext:d}=Z(),{token:c}=d,[a,i]=e.useState(!1),[o,_]=e.useState(),k=e.useRef(null),u=e.useCallback(n=>{r(x.showNotification({status:"error",title:"Error!",message:n}))},[r]);return e.useEffect(()=>{(async()=>{if(!a&&c){i(!1);try{const n=await D(c);if(i(!0),n.error){u(`${n.error}`);return}n.success&&_(n)}catch(n){u(`${n}`),i(!0);return}}})()},[c,a,u]),e.useEffect(()=>{const n=o==null?void 0:o.notebooks,g=o==null?void 0:o.error,f=(n==null?void 0:n.map(l=>l._id).join(","))||null;if(!(f&&k.current===f)){if(n&&n.length>0){const h=[...n.map(s=>s.updatedAt==="No date"||s.updatedAt===void 0?{...s,updatedAt:"December 17, 1995 03:24:00"}:s)].sort((s,m)=>s.updatedAt!==void 0&&m.updatedAt!==void 0?new Date(s.updatedAt)>new Date(m.updatedAt)?1:-1:s.updatedAt!==void 0?1:-1).reverse();_({...o,notebooks:h}),k.current=f,i(!0)}g&&r(x.showNotification({status:"error",title:"Error!",message:o.error}))}},[o==null?void 0:o.notebooks,r,o]),t.jsxs(e.Fragment,{children:[!a&&t.jsx(A,{}),t.jsx("div",{className:"page_scrollable_header_breadcrumb_footer_list",children:a&&(o==null?void 0:o.notebooks)&&t.jsx(Y,{notebooks:o})})]})};export{at as default};
